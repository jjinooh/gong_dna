<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>공무원 DNA 테스트</title>
  <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
  <script>
  Kakao.init('3138aed7cfa6cb0fbdca2b0e71a77461'); // JavaScript 키
  </script>

  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f7f9fc;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      width: 90vw;
      max-width: 420px;
      height: 90vh;
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      text-align: center;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-sizing: border-box; /* 패딩이 너비를 초과하지 않도록 설정 */
    }
    .container.show {
      display: flex;
    }
    h1, h2, p {
      margin-bottom: 12px;
    }
    button {
      padding: 10px 20px;
      margin: 6px;
      font-size: 15px;
      border: none;
      border-radius: 10px;
      background: #5a8dee;
      color: white;
      cursor: pointer;
      width: 80%;
      max-width: 300px; /* 버튼 최대 너비 설정 */
    }
    select {
      padding: 8px;
      width: 80%;
      max-width: 300px;
      font-size: 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 15px;
    }
    .comment {
      font-size: 12px;
      color: #888;
      margin-top: 8px;
    }
    #result img {
      width: 120px;
      height: auto; /* 이미지 비율 유지 */
      margin-bottom: 10px;
      border-radius: 8px;
    }
    #resultText {
      white-space: pre-wrap; /* 줄바꿈 유지 */
      margin-bottom: 20px;
      font-size: 16px;
      font-weight: bold;
      line-height: 1.5;
    }
    #questions .container {
        justify-content: flex-start; /* 질문은 상단에 배치 */
        padding-top: 30px;
    }
    #questions strong {
        font-size: 1.2em;
        display: block;
        margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container show" id="userinfo">
    <h2>공직 경력 체크</h2>
    <p>당신의 공직 연차를 알려주세요!</p>
    <select id="experience">
      <option value="1년 미만">🍼 1년 미만</option>
      <option value="1~3년">🌱 1~3년</option>
      <option value="4~7년">🌳 4~7년</option>
      <option value="8년 이상">🧘 8년 이상</option>
    </select>
    <button onclick="saveUserInfo()">테스트 시작하기</button>
  </div>
  
  <div class="container" id="intro">
    <h1>공무원 DNA 테스트 🧬</h1>
    <p>나는 공무원을 계속할 상인가?</p>
    <button onclick="startTest()">시작!</button>
    <div class="comment">* 본 테스트는 재미용입니다 :)</div>
  </div>
  
  <div id="questions"></div>
  
  <div class="container" id="result">
    <h2>🎯 당신의 결과는?</h2>
    <img id="resultImage" src="" alt="결과 이미지">
    <p id="resultText"></p>
    <button onclick="copyResult()">🔗 결과 복사</button>
    <button onclick="shareKakao()">💬 카카오톡 공유</button>
    <button onclick="location.reload()">🔁 다시 하기</button>
    <!-- 만든 사람 정보 -->
    <div class="comment" style="margin-top: 20px; font-size: 13px; color: #999;">
      Made by <strong>JINO</strong><br>
      #출근고민만100번째 #내면분투형
    </div>
  </div>
  
  <script>
    let userInfo = {};
    let answers = [];
    let currentQuestion = 0;
    
    // 각 답변마다 점수를 직접 부여하는 방식으로 변경 (스코어가 높을수록 번아웃/퇴사형에 가까움)
    const baseQuestions = [
      { 
        text: "퇴근 후 당신의 모습은?", 
        options: [
          { text: "📚 오늘도 자기계발!", score: 0 },
          { text: "🛏️ 침대와 혼연일체", score: 1 },
          { text: "🍕 넷플릭스+배달앱 콜라보", score: 2 },
          { text: "🤯 회의감에 빠짐", score: 3 }
        ] 
      },
      { 
        text: "당신이 주로 쓰는 말은?", 
        options: [
          { text: "이건 왜 이렇게 비효율적이죠?", score: 1 },
          { text: "결재 드렸습니다.", score: 0 },
          { text: "이게 다 시민을 위한 일이죠.", score: 0 },
          { text: "오늘은 누가 또 터뜨렸나…", score: 2 }
        ] 
      },
      { branch: true, key: "q2Map" }, /* q2Map에서 해당 연차 질문 가져옴 */
      { 
        text: "당신의 업무 몰입 스타일은?", 
        options: [
          { text: "😤 일단 끝내고 나중에 쉰다", score: 0 },
          { text: "🧘 중간중간 쉬는 게 중요하다", score: 1 },
          { text: "🤹‍♀️ 몇 가지 일을 동시에 처리한다", score: 1 },
          { text: "🙈 딴짓하다 마감 직전 몰아친다", score: 3 }
        ] 
      },
      { 
        text: "회의할 때 나는 어떤 사람?", 
        options: [
          { text: "📣 적극적으로 의견을 낸다", score: 0 },
          { text: "📝 메모하고 듣는 편이다", score: 1 },
          { text: "😓 질문 받을까 봐 조마조마", score: 2 },
          { text: "🙃 이미 멍 때리는 중", score: 3 }
        ] 
      },
      { 
        text: "보고서를 쓸 때 나는?", 
        options: [
          { text: "🧐 구조부터 치밀하게 짠다", score: 0 },
          { text: "😓 빈 화면 앞에서 멍…", score: 2 },
          { text: "🙋 사례부터 긁어온다", score: 1 },
          { text: "😇 선배 문서 복붙 + 살짝 수정", score: 2 }
        ] 
      },
      { branch: true, key: "branchQuestions" }, /* branchQuestions에서 해당 연차 질문 가져옴 */
      { 
        text: "회식 소식이 들리면?", 
        options: [
          { text: "🎉 오랜만에 사람들과 수다 떨 기회", score: 0 },
          { text: "🤔 누구 오는지 먼저 확인", score: 1 },
          { text: "😩 또 회식…", score: 2 },
          { text: "🙈 몰랐던 척 조용히 집 간다", score: 3 }
        ] 
      },
      { 
        text: "\"요즘 일 어때?\"라는 친구 질문에 대한 속마음은?", 
        options: [
          { text: "😊 보람 있어", score: 0 },
          { text: "😕 말하면 길어", score: 1 },
          { text: "😩 그냥 버티는 중", score: 2 },
          { text: "🙄 또 그 얘기야?", score: 3 }
        ] 
      },
      { 
        text: "나에게 공무원이라는 일은...", 
        options: [
          { text: "💼 사회를 지탱하는 책임감 있는 일", score: 0 },
          { text: "💸 안정적이라 선택한 생계형 직업", score: 1 },
          { text: "😶‍🌫️ 의미는 점점 흐려지는 중", score: 2 },
          { text: "🎭 일과 나를 분리한 이중생활", score: 3 }
        ] 
      },
      { branch: true, key: "branchQuestions2" }, /* 추가 분기 질문 필요 시 */
      { 
        text: "요즘 내 퇴사 욕구는?", 
        options: [
          { text: "💣 매우 높음 – 퇴사 각", score: 3 },
          { text: "🔥 가끔 욱하지만 참음", score: 2 },
          { text: "🧊 낮음 – 안정 최고", score: 1 },
          { text: "😇 없음 – 나는 공무원이 천직", score: 0 }
        ] 
      }
    ];

    // 연차별 고유 질문 (q2Map) - 옵션에 점수 직접 부여
    const q2Map = {
      "1년 미만": {
        text: "요즘 당신 입에서 자주 나오는 말은?",
        options: [
          { text: "아직도 헷갈려요...", score: 1 },
          { text: "혹시 이것도 제가 할까요?", score: 0 },
          { text: "매뉴얼이랑 실제가 너무 달라요", score: 2 },
          { text: "오…이걸 저한테요?", score: 1 }
        ]
      },
      "1~3년": {
        text: "요즘 당신 입에서 자주 나오는 말은?",
        options: [
          { text: "그건 제가 담당이 아닌데요…", score: 1 },
          { text: "결재 드렸습니다", score: 0 },
          { text: "이거 왜 또 바꼈어요?", score: 2 },
          { text: "매뉴얼 어디 있어요?", score: 1 }
        ]
      },
      "4~7년": {
        text: "요즘 당신 입에서 자주 나오는 말은?",
        options: [
          { text: "그건 제가 담당이 아닌데요…", score: 1 },
          { text: "결재 드렸습니다", score: 0 },
          { text: "이거 왜 또 바꼈어요?", score: 2 },
          { text: "매뉴얼 어디 있어요?", score: 1 }
        ]
      },
      "8년 이상": {
        text: "요즘 당신 입에서 자주 나오는 말은?",
        options: [
          { text: "그거 옛날에도 문제 있었어", score: 1 },
          { text: "내가 말했잖아 그때", score: 1 },
          { text: "또 바뀌었대요. 지침 내려온대", score: 1 },
          { text: "안 그래도 보고 있었어요", score: 0 }
        ]
      }
    };

    // 연차별 분기 질문 (branchQuestions) - 옵션에 점수 직접 부여
    const branchQuestions = {
      "1년 미만": [
        { 
          text: "요즘 공직생활 어때?", 
          options: [
            { text: "🙃 아직 적응 중이에요", score: 1 },
            { text: "🤯 벌써 퇴사각", score: 3 },
            { text: "🤓 새로 배우는 게 재밌어요", score: 0 }
          ] 
        },
        { 
          text: "부서 이동 얘기가 나오면?", 
          options: [
            { text: "😱 벌써요?!", score: 1 },
            { text: "🤔 그냥 보내주세요...", score: 2 },
            { text: "🧭 아직 여긴 어디 나는 누구", score: 1 }
          ] 
        },
        { 
          text: "공무원 되길 잘했다고 느낄 때는?", 
          options: [
            { text: "📅 월급일", score: 1 },
            { text: "🧘 주말에 출근 안 할 때", score: 1 },
            { text: "🙋 아직은 모르겠어요", score: 2 }
          ] 
        }
      ],
      "1~3년": [
        { 
          text: "요즘 동료들이랑은 어때?", 
          options: [
            { text: "😌 그냥저냥 무난", score: 1 },
            { text: "🤬 눈치+정치+피로 그 자체", score: 3 },
            { text: "🙃 출근만 따로 하고 싶어요", score: 2 }
          ] 
        },
        { 
          text: "부서 이동 얘기가 나오면?", 
          options: [
            { text: "🧳 다른 부서도 가보고 싶긴 함", score: 1 },
            { text: "😤 누가 나 밀어내는 건가?", score: 2 },
            { text: "🙃 익숙한 게 좋아요", score: 0 }
          ] 
        },
        { 
          text: "공무원 되길 잘했다고 느낄 때는?", 
          options: [
            { text: "🏖️ 연가 쓸 때", score: 1 },
            { text: "😎 신입들이 부러워할 때", score: 0 },
            { text: "🧾 제도나 절차 잘 이해될 때", score: 0 }
          ] 
        }
      ],
      "4~7년": [
        { 
          text: "요즘 동료들이랑은 어때?", 
          options: [
            { text: "😌 그냥저냥 무난", score: 1 },
            { text: "🤬 눈치+정치+피로 그 자체", score: 3 },
            { text: "🙃 출근만 따로 하고 싶어요", score: 2 }
          ] 
        },
        { 
          text: "부서 이동 얘기가 나오면?", 
          options: [
            { text: "🧳 다른 부서도 가보고 싶긴 함", score: 1 },
            { text: "😤 누가 나 밀어내는 건가?", score: 2 },
            { text: "🙃 익숙한 게 좋아요", score: 0 }
          ] 
        },
        { 
          text: "공무원 되길 잘했다고 느낄 때는?", 
          options: [
            { text: "🏖️ 연가 쓸 때", score: 1 },
            { text: "😎 신입들이 부러워할 때", score: 0 },
            { text: "🧾 제도나 절차 잘 이해될 때", score: 0 }
          ] 
        }
      ],
      "8년 이상": [
        { 
          text: "공직생활 8년차, 나는...", 
          options: [
            { text: "🧘 흐름만 보면 다 보여요", score: 0 },
            { text: "🤕 후배들 보면 내가 옛날 생각나요", score: 1 },
            { text: "🔥 조직개혁의 불꽃을 다시 켤까?", score: 2 }
          ] 
        },
        { 
          text: "부서 이동 얘기가 나오면?", 
          options: [
            { text: "🧘 어디든 상관없습니다", score: 0 },
            { text: "🤖 어차피 다 거기서 거기", score: 2 },
            { text: "🔁 반복되는 인사이동… 이제 체념", score: 3 }
          ] 
        },
        { 
          text: "공무원 되길 잘했다고 느낄 때는?", 
          options: [
            { text: "👏 남들이 부러워할 때", score: 0 },
            { text: "🤓 정책 흐름이 술술 읽힐 때", score: 0 },
            { text: "💰 정년이 보장될 때", score: 1 }
          ] 
        }
      ]
    };
    
    // 이 부분은 추가적인 분기 질문이 필요할 경우 사용합니다. (현재 사용 안 함)
    const branchQuestions2 = {
        "1년 미만": [
            { text: "추가 1-1", options: [{ text: "선택1", score:0}, {text: "선택2", score:1}] }
        ],
        // ... 나머지 연차별 질문
    };


    // 결과 유형의 조건 (점수 범위 조정)
    const resultTypes = [
      {
        name: '천직형 🌟',
        desc: '안정과 루틴을 사랑하는 천직형! 당신은 공직 DNA 그 자체입니다.',
        condition: a => a <= 5 // 5점 이하는 천직형
      },
      {
        name: '내면 분투형 🌀',
        desc: '겉으로는 멀쩡, 속은 복잡한 고민의 연속. 늘 출근길에 생각이 많다.',
        condition: a => a > 5 && a <= 10 // 6~10점은 내면 분투형
      },
      {
        name: '갈팡질팡형 🤹‍♀️',
        desc: '이직과 안정 사이에서 고민 중. 매일 출근 전 한숨을 쉰다면 당신!',
        condition: a => a > 10 && a <= 15 // 11~15점은 갈팡질팡형
      },
      {
        name: '번아웃형 🔥',
        desc: '이미 마음은 퇴사 중... 현실은 계속 근무 중... 휴식이 필요해요!',
        condition: a => a > 15 && a <= 20 // 16~20점은 번아웃형
      },
      {
        name: '퇴사각형 💣',
        desc: '지금 안 그만두면 병날 것 같다면? 이 테스트 끝나고 바로 명상 ㄱ',
        condition: a => a > 20 // 21점 이상은 퇴사각형
      }
    ];

    // 결과 이미지 매핑 (GitHub 레포에서 이미지를 가져옵니다)
    const imageMap = {
      '갈팡질팡형 🤹‍♀️': 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/main/PENUP_20250802_063752.png',
      '퇴사각형 💣': 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/main/PENUP_20250802_064207.png',
      '천직형 🌟': 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/main/PENUP_20250802_070019%20(1).png',
      '번아웃형 🔥': 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/main/PENUP_20250802_070136.png',
      '내면 분투형 🌀': 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/main/file_000000003ab861f9b0555ad3a325e417.png'
    };
    
    // 시작 함수
    function startTest() {
      document.getElementById('intro').classList.remove('show');
      showNextQuestion();
    }

    // 유저 정보 저장 및 테스트 시작 준비
    function saveUserInfo() {
      const exp = document.getElementById('experience').value;
      userInfo = { experience: exp };
      
      // Q2 질문을 q2Map에서 가져와 baseQuestions의 2번째(index 2) 항목에 대체
      const q2Data = q2Map[exp];
      if (q2Data) {
          baseQuestions[2] = {
              text: q2Data.text,
              options: q2Data.options // q2Map의 옵션은 이미 점수 포함
          };
      } else {
          // q2Data가 없을 경우의 기본값 또는 오류 처리
          console.error("q2Data for experience not found:", exp);
      }

      document.getElementById('userinfo').classList.remove('show');
      document.getElementById('intro').classList.add('show');
    }

    // 다음 질문 표시 함수
    function showNextQuestion() {
      const qWrap = document.getElementById('questions');
      qWrap.innerHTML = ''; // 기존 질문 제거
    
      if (currentQuestion >= baseQuestions.length) {
        showResult(); // 모든 질문이 끝나면 결과 표시
        return;
      }
    
      let currentQData = baseQuestions[currentQuestion];
      let finalQ = currentQData; // 최종적으로 표시할 질문 데이터

      // 'branch' 속성이 true이면 해당 연차의 분기 질문을 가져옴
      if (currentQData.branch) {
        if (currentQData.key === "q2Map") {
             // Q2 질문은 이미 saveUserInfo에서 baseQuestions[2]에 넣어두었으므로 따로 처리할 필요 없음.
             // 다만 currentQData.branch가 true이고 key가 "q2Map"인 경우 이 코드를 실행하지 않도록 해야 함.
             // 이 로직은 baseQuestions 정의 시 이미 q2Map 데이터가 주입된 후 실행되므로, 이 branch를 처리하지 않도록 합니다.
             // Q2는 `baseQuestions` 배열 내에서 실제 데이터로 대체되었으므로,
             // 이 `if` 블록을 통과하지 않도록 하는 것이 맞습니다.
        } else if (currentQData.key === "branchQuestions" && branchQuestions[userInfo.experience]) {
            // 해당 연차의 분기 질문이 있으면 가져오고, 없으면 기본 baseQuestions를 유지
            if (branchQuestions[userInfo.experience].length > 0) {
                // 한 번 사용된 분기 질문은 배열에서 제거 (shift)
                finalQ = branchQuestions[userInfo.experience].shift();
            } else {
                // 해당 연차에 더 이상 분기 질문이 없으면 다음 기본 질문으로 넘어감
                currentQuestion++;
                showNextQuestion();
                return;
            }
        } else if (currentQData.key === "branchQuestions2" && branchQuestions2[userInfo.experience]) {
            if (branchQuestions2[userInfo.experience].length > 0) {
                finalQ = branchQuestions2[userInfo.experience].shift();
            } else {
                currentQuestion++;
                showNextQuestion();
                return;
            }
        }
      }

      // 질문 DOM 요소 생성 및 추가
      const qDiv = document.createElement('div');
      qDiv.className = 'container show'; // 새로운 질문 컨테이너 표시

      const qTitle = document.createElement('p');
      qTitle.innerHTML = `<strong>Q${currentQuestion + 1}.</strong> ${finalQ.text}`;
      qDiv.appendChild(qTitle);

      // 옵션 버튼 생성 (새로운 점수 체계 옵션 객체 배열 형식만 처리)
      finalQ.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.innerText = opt.text;
        btn.onclick = () => {
          answers.push(opt); // 선택된 옵션 객체 (text와 score 포함) 저장
          currentQuestion++;
          qDiv.remove(); // 현재 질문 컨테이너 제거
          showNextQuestion(); // 다음 질문 표시
        };
        qDiv.appendChild(btn);
      });

      qWrap.appendChild(qDiv);
      // 현재 질문 컨테이너가 questions div 안에 들어가게 설정되었으므로, qWrap을 직접 show 할 필요는 없습니다.
      // qWrap.classList.add('show');
    }

    // 결과 계산 및 표시 함수
    function showResult() {
      document.getElementById('questions').innerHTML = ''; // 질문 영역 비우기
      document.getElementById('result').classList.add('show'); // 결과 컨테이너 표시
    
      // 총점 계산
      let totalScore = 0;
      answers.forEach(answer => {
        // answers 배열에는 { text: "...", score: ... } 형태의 객체가 저장됩니다.
        if (typeof answer === 'object' && 'score' in answer) {
          totalScore += answer.score;
        }
        // 예전 방식의 문자열만 저장된 경우를 위한 호환성 코드는 이제 필요 없음 (모든 옵션에 score가 있기 때문)
      });
    
      // 결과 유형 결정 (condition에 따라 find)
      const result = resultTypes.find(r => r.condition(totalScore));
      
      // 결과 이미지와 텍스트 설정
      document.getElementById('resultImage').src = imageMap[result.name];
      document.getElementById('resultText').innerText = `${result.name}\n${result.desc}`;
    }

    // 결과 텍스트 복사 함수
    function copyResult() {
      const text = document.getElementById('resultText').innerText;
      const url = window.location.href.split('?')[0]; // 쿼리 파라미터 제외하고 현재 URL 가져오기
      navigator.clipboard.writeText(`${text}\n\n테스트 해보기 👉 ${url}`).then(() => {
        alert('결과와 링크가 복사되었어요! 붙여넣기로 공유해보세요 🎉');
      }).catch(err => {
        console.error('클립보드 복사 실패:', err);
        alert('결과 복사에 실패했어요. 수동으로 복사해주세요!');
      });
    }

    // 카카오톡 공유 함수
    function shareKakao() {
      const resultTextElement = document.getElementById('resultText');
      if (!resultTextElement) {
        console.error("resultTextElement not found for Kakao Share");
        return;
      }
      const fullResultText = resultTextElement.innerText;
      const resultName = fullResultText.split('\n')[0]; // 결과 유형만 추출
      const resultDesc = fullResultText.split('\n').slice(1).join('\n'); // 설명 부분 추출
      const resultImage = document.getElementById('resultImage').src;
      const currentUrl = window.location.href.split('?')[0]; // 쿼리 파라미터 제외

      if (!Kakao.isInitialized()) {
          console.error("Kakao SDK is not initialized.");
          return;
      }

      Kakao.Link.sendDefault({
        objectType: 'feed',
        content: {
          title: '나는 공무원을 계속할 상인가?',
          description: `테스트 결과: ${resultName}\n${resultDesc}`, // 결과 이름과 설명 모두 포함
          imageUrl: resultImage,
          link: {
            mobileWebUrl: currentUrl,
            webUrl: currentUrl
          }
        },
        buttons: [
          {
            title: '테스트 해보기',
            link: {
              mobileWebUrl: currentUrl,
              webUrl: currentUrl
            }
          }
        ]
      });
    }
  </script>
</body>
</html>      ] 
    },
    { 
      text: "부서 이동 얘기가 나오면?", 
      options: [
        { text: "😱 벌써요?!", score: 1 },
        { text: "🤔 그냥 보내주세요...", score: 2 },
        { text: "🧭 아직 여긴 어디 나는 누구", score: 1 }
      ] 
    },
    { 
      text: "공무원 되길 잘했다고 느낄 때는?", 
      options: [
        { text: "📅 월급일", score: 1 },
        { text: "🧘 주말에 출근 안 할 때", score: 1 },
        { text: "🙋 아직은 모르겠어요", score: 2 }
      ] 
    }
  ],
  "1~3년": [
    { 
      text: "요즘 동료들이랑은 어때?", 
      options: [
        { text: "😌 그냥저냥 무난", score: 1 },
        { text: "🤬 눈치+정치+피로 그 자체", score: 3 },
        { text: "🙃 출근만 따로 하고 싶어요", score: 2 }
      ] 
    },
    { 
      text: "부서 이동 얘기가 나오면?", 
      options: [
        { text: "🧳 다른 부서도 가보고 싶긴 함", score: 1 },
        { text: "😤 누가 나 밀어내는 건가?", score: 2 },
        { text: "🙃 익숙한 게 좋아요", score: 0 }
      ] 
    },
    { 
      text: "공무원 되길 잘했다고 느낄 때는?", 
      options: [
        { text: "🏖️ 연가 쓸 때", score: 1 },
        { text: "😎 신입들이 부러워할 때", score: 0 },
        { text: "🧾 제도나 절차 잘 이해될 때", score: 0 }
      ] 
    }
  ],
  "4~7년": [
    { 
      text: "요즘 동료들이랑은 어때?", 
      options: [
        { text: "😌 그냥저냥 무난", score: 1 },
        { text: "🤬 눈치+정치+피로 그 자체", score: 3 },
        { text: "🙃 출근만 따로 하고 싶어요", score: 2 }
      ] 
    },
    { 
      text: "부서 이동 얘기가 나오면?", 
      options: [
        { text: "🧳 다른 부서도 가보고 싶긴 함", score: 1 },
        { text: "😤 누가 나 밀어내는 건가?", score: 2 },
        { text: "🙃 익숙한 게 좋아요", score: 0 }
      ] 
    },
    { 
      text: "공무원 되길 잘했다고 느낄 때는?", 
      options: [
        { text: "🏖️ 연가 쓸 때", score: 1 },
        { text: "😎 신입들이 부러워할 때", score: 0 },
        { text: "🧾 제도나 절차 잘 이해될 때", score: 0 }
      ] 
    }
  ],
  "8년 이상": [
    { 
      text: "공직생활 8년차, 나는...", 
      options: [
        { text: "🧘 흐름만 보면 다 보여요", score: 0 },
        { text: "🤕 후배들 보면 내가 옛날 생각나요", score: 1 },
        { text: "🔥 조직개혁의 불꽃을 다시 켤까?", score: 2 }
      ] 
    },
    { 
      text: "부서 이동 얘기가 나오면?", 
      options: [
        { text: "🧘 어디든 상관없습니다", score: 0 },
        { text: "🤖 어차피 다 거기서 거기", score: 2 },
        { text: "🔁 반복되는 인사이동… 이제 체념", score: 3 }
      ] 
    },
    { 
      text: "공무원 되길 잘했다고 느낄 때는?", 
      options: [
        { text: "👏 남들이 부러워할 때", score: 0 },
        { text: "🤓 정책 흐름이 술술 읽힐 때", score: 0 },
        { text: "💰 정년이 보장될 때", score: 1 }
      ] 
    }
  ]
};

// q2Map도 점수 체계로 수정
const q2Map = {
  "1년 미만": {
    text: "요즘 당신 입에서 자주 나오는 말은?",
    options: [
      { text: "아직도 헷갈려요...", score: 1 },
      { text: "혹시 이것도 제가 할까요?", score: 0 },
      { text: "매뉴얼이랑 실제가 너무 달라요", score: 2 },
      { text: "오…이걸 저한테요?", score: 1 }
    ]
  },
  "1~3년": {
    text: "요즘 당신 입에서 자주 나오는 말은?",
    options: [
      { text: "그건 제가 담당이 아닌데요…", score: 1 },
      { text: "결재 드렸습니다", score: 0 },
      { text: "이거 왜 또 바꼈어요?", score: 2 },
      { text: "매뉴얼 어디 있어요?", score: 1 }
    ]
  },
   "4~7년": {
    text: "요즘 당신 입에서 자주 나오는 말은?",
    options: [
      { text: "그건 제가 담당이 아닌데요…", score: 1 },
      { text: "결재 드렸습니다", score: 0 },
      { text: "이거 왜 또 바꼈어요?", score: 2 },
      { text: "매뉴얼 어디 있어요?", score: 1 }
    ]
  },
  "8년 이상": {
    text: "요즘 당신 입에서 자주 나오는 말은?",
    options: [
      { text: "그거 옛날에도 문제 있었어", score: 1 },
      { text: "내가 말했잖아 그때", score: 1 },
      { text: "또 바뀌었대요. 지침 내려온대", score: 1 },
      { text: "안 그래도 보고 있었어요", score: 0 }
    ]
  }
};

// 결과 유형의 조건도 점수 기반으로 변경
const resultTypes = [
  {
    name: '천직형 🌟',
    desc: '안정과 루틴을 사랑하는 천직형! 당신은 공직 DNA 그 자체입니다.',
    condition: a => a <= 5 // 5점 이하는 천직형
  },
  {
    name: '내면 분투형 🌀',
    desc: '겉으로는 멀쩡, 속은 복잡한 고민의 연속. 늘 출근길에 생각이 많다.',
    condition: a => a <= 10 // 6~10점은 내면 분투형
  },
  {
    name: '갈팡질팡형 🤹‍♀️',
    desc: '이직과 안정 사이에서 고민 중. 매일 출근 전 한숨을 쉰다면 당신!',
    condition: a => a <= 15 // 11~15점은 갈팡질팡형
  },
  {
    name: '번아웃형 🔥',
    desc: '이미 마음은 퇴사 중... 현실은 계속 근무 중... 휴식이 필요해요!',
    condition: a => a <= 20 // 16~20점은 번아웃형
  },
  {
    name: '퇴사각형 💣',
    desc: '지금 안 그만두면 병날 것 같다면? 이 테스트 끝나고 바로 명상 ㄱ',
    condition: a => a > 20 // 21점 이상은 퇴사각형
  }
];

// showNextQuestion 함수 수정
function showNextQuestion() {
  const qWrap = document.getElementById('questions');
  qWrap.innerHTML = '';

  if (currentQuestion >= baseQuestions.length) {
    showResult();
    return;
  }

  const qData = baseQuestions[currentQuestion];

  let finalQ = qData;
  if (qData.branch) {
    const branchSet = branchQuestions[userInfo.experience];
    finalQ = branchSet.shift();
  }

  const qDiv = document.createElement('div');
  qDiv.className = 'container show';

  const qTitle = document.createElement('p');
  qTitle.innerHTML = `<strong>Q${currentQuestion + 1}.</strong> ${finalQ.text}`;
  qDiv.appendChild(qTitle);

  // 각 옵션의 버튼 생성 (점수 체계 반영)
  if (Array.isArray(finalQ.options)) {
    // 기존 방식의 옵션 배열인 경우
    finalQ.options.forEach((opt, index) => {
      const btn = document.createElement('button');
      btn.innerText = opt;
      btn.onclick = () => {
        // 기본 점수는 index에 따라 0부터 증가
        answers.push({ text: opt, score: index });
        currentQuestion++;
        qDiv.remove();
        showNextQuestion();
      };
      qDiv.appendChild(btn);
    });
  } else {
    // 새로운 점수 체계가 적용된 옵션 객체 배열인 경우
    finalQ.options.forEach(opt => {
      const btn = document.createElement('button');
      btn.innerText = opt.text;
      btn.onclick = () => {
        answers.push(opt);
        currentQuestion++;
        qDiv.remove();
        showNextQuestion();
      };
      qDiv.appendChild(btn);
    });
  }

  qWrap.appendChild(qDiv);
}

// showResult 함수 수정
function showResult() {
  document.getElementById('questions').innerHTML = '';
  document.getElementById('result').classList.add('show');

  // 총점 계산
  let totalScore = 0;
  answers.forEach(answer => {
    if (typeof answer === 'object' && 'score' in answer) {
      totalScore += answer.score;
    } else if (typeof answer === 'string') {
      // 기존 방식 호환성 유지 (burnoutKeywords 검사)
      const hasKeyword = burnoutKeywords.some(word => answer.includes(word));
      if (hasKeyword) totalScore += 1;
    }
  });

  // 결과 유형 결정
  const result = resultTypes.find(r => r.condition(totalScore));

  document.getElementById('resultImage').src = imageMap[result.name];
  document.getElementById('resultText').innerText = `${result.name}\n${result.desc}`;
}

// saveUserInfo 함수도 수정
function saveUserInfo() {
  const exp = document.getElementById('experience').value;
  userInfo = { experience: exp };
  
  // q2Map을 새로운 점수 체계에 맞게 적용
  const q2Data = q2Map[exp];
  baseQuestions[1] = {
    text: q2Data.text,
    options: q2Data.options.map((text, index) => ({ text, score: index }))
  };
  
  document.getElementById('userinfo').classList.remove('show');
  document.getElementById('intro').classList.add('show');
}
    // 기존의 showNextQuestion 함수를 새로운 점수 체계에 맞게 수정
function showNextQuestion() {
  const qWrap = document.getElementById('questions');
  qWrap.innerHTML = '';

  if (currentQuestion >= baseQuestions.length) {
    showResult();
    return;
  }

  const qData = baseQuestions[currentQuestion];

  let finalQ = qData;
  if (qData.branch) {
    const branchSet = branchQuestions[userInfo.experience];
    finalQ = branchSet.shift();
  }

  const qDiv = document.createElement('div');
  qDiv.className = 'container show';

  const qTitle = document.createElement('p');
  qTitle.innerHTML = `<strong>Q${currentQuestion + 1}.</strong> ${finalQ.text}`;
  qDiv.appendChild(qTitle);

  // 새로운 옵션 형식 처리
  if (Array.isArray(finalQ.options) && typeof finalQ.options[0] === 'object') {
    // 새로운 형식: 객체 배열 [{text: "텍스트", score: 점수}]
    finalQ.options.forEach(opt => {
      const btn = document.createElement('button');
      btn.innerText = opt.text;
      btn.onclick = () => {
        answers.push(opt); // 객체 전체를 저장
        currentQuestion++;
        qDiv.remove();
        showNextQuestion();
      };
      qDiv.appendChild(btn);
    });
  } else {
    // 기존 형식: 문자열 배열 ["텍스트1", "텍스트2"]
    finalQ.options.forEach((opt, index) => {
      const btn = document.createElement('button');
      btn.innerText = opt;
      btn.onclick = () => {
        // 이전 방식 호환성 유지
        answers.push({text: opt, score: index});
        currentQuestion++;
        qDiv.remove();
        showNextQuestion();
      };
      qDiv.appendChild(btn);
    });
  }

  qWrap.appendChild(qDiv);
}

// 결과 계산 함수 수정
function showResult() {
  document.getElementById('questions').innerHTML = '';
  document.getElementById('result').classList.add('show');

  // 총점 계산
  let totalScore = 0;
  answers.forEach(answer => {
    if (typeof answer === 'object' && 'score' in answer) {
      totalScore += answer.score;
    } else if (typeof answer === 'string') {
      // 기존 방식 호환성 유지 (burnoutKeywords 검사)
      const hasKeyword = burnoutKeywords.some(word => answer.includes(word));
      if (hasKeyword) totalScore += 1;
    }
  });

  // 결과 유형 결정
  const result = resultTypes.find(r => r.condition(totalScore));

  document.getElementById('resultImage').src = imageMap[result.name];
  document.getElementById('resultText').innerText = `${result.name}\n${result.desc}`;
}

// 결과 복사 함수
function copyResult() {
  const text = document.getElementById('resultText').innerText;
  const url = window.location.href;
  navigator.clipboard.writeText(`${text}\n\n테스트 해보기 👉 ${url}`).then(() => {
    alert('결과와 링크가 복사되었어요! 붙여넣기로 공유해보세요 🎉');
  });
}

// 카카오톡 공유 함수
function shareKakao() {
  Kakao.Link.sendDefault({
    objectType: 'feed',
    content: {
      title: '나는 공무원을 계속할 상인가?',
      description: '테스트 결과를 확인해보세요!',
      imageUrl: 'https://raw.githubusercontent.com/jjinooh/gongmoo-dna-assets/refs/heads/main/unnamed.png',
      link: {
        mobileWebUrl: window.location.href,
        webUrl: window.location.href
      }
    },
    buttons: [
      {
        title: '테스트 해보기',
        link: {
          mobileWebUrl: window.location.href,
          webUrl: window.location.href
        }
      }
    ]
  });
}
  </script></body>
</html>
